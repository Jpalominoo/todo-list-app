<div class="flex-container-column task-list-container">
    <h1>{{ pageTitle }}</h1>
</div>

<!-- Task list section -->
<ul *ngIf="(filteredTasks$ | async) as tasksForStatus" class="task-list">
  <li *ngFor="let task of tasksForStatus; let i = index" class="task-card">
    <div class="task-header">
      <strong>{{ task.title }}</strong>
      <span class="status-badge" [ngClass]="task.status">{{ task.status | titlecase }}</span>
      <!-- Expand/collapse button -->
      <button (click)="expandedIndex = expandedIndex === i ? -1 : i" class="expand-btn" [attr.aria-label]="expandedIndex === i ? 'Collapse' : 'Expand'">
        <i class="pi" [ngClass]="expandedIndex === i ? 'pi-chevron-up' : 'pi-chevron-down'"></i>
      </button>
      <!-- Edit button -->
      <button (click)="openRightMenu(task)" class="edit-btn" aria-label="Edit Task">
        <i class="pi pi-pencil"></i>
      </button>
    </div>
    <div *ngIf="expandedIndex === i" class="task-details">
      <p><strong>Description:</strong> {{ task.description || 'No description' }}</p>
      <p><strong>ID:</strong> {{ task.id }}</p>
      <!-- Add more details here if needed -->
    </div>
  </li>
</ul>

<!-- Right menu for editing tasks -->
<todo-list-right-menu *ngIf="showRightMenu" [task]="selectedTask" class="right-menu-float" (closeMenu)="closeRightMenu()" (saveTaskEvent)="updateTask($event)">
</todo-list-right-menu>

<!-- Message if no tasks are found -->
<div *ngIf="(filteredTasks$ | async)?.length === 0">
  <p>No tasks found for this status.</p>
</div>

<script>
  // Used for expand/collapse state
  let expandedIndex = -1;
</script>

<style>
body, .bg-slate-100 {
  background: #e0e7ff !important;
}
.flex-container-column {
  background: #f1f5ff;
  border-radius: 12px;
  padding: 2rem 1.5rem 1.5rem 1.5rem;
  margin-bottom: 2rem;
  box-shadow: 0 2px 12px rgba(37, 99, 235, 0.08);
}
.task-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: flex;
  flex-direction: column;
  gap: 1rem;
}
.task-card {
  background: #f1f5ff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(37,99,235,0.08);
  padding: 1rem;
  transition: box-shadow 0.2s;
  position: relative;
  border-left: 4px solid #2563eb;
  width: 91%;
  margin: 0 auto;
  margin-left: -0.01%;
}
.task-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.status-badge {
  background: #2563eb;
  color: #fff;
  border-radius: 12px;
  padding: 0.2rem 0.8rem;
  font-size: 0.85rem;
  margin-left: 1rem;
  box-shadow: 0 1px 4px rgba(37,99,235,0.10);
}
.expand-btn {
  background: none;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  margin-left: 1rem;
  display: flex;
  align-items: center;
}
.expand-btn .pi {
  font-size: 1.3rem;
  color: #2563eb;
}
.task-details {
  margin-top: 1rem;
  color: #3730a3;
  font-size: 0.98rem;
}
.edit-btn {
  background: none;
  border: none;
  font-size: 1.2rem;
  cursor: pointer;
  margin-left: 0.5rem;
  color: #2563eb;
  display: flex;
  align-items: center;
}
.edit-btn .pi {
  font-size: 1.2rem;
}
.close-right-menu {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: none;
  border: none;
  font-size: 2rem;
  color: #2563eb;
  cursor: pointer;
  z-index: 1100;
  transition: color 0.2s;
}
.close-right-menu:hover {
  color: #1e40af;
}
.right-menu-float {
  position: fixed;
  top: 0;
  right: 0;
  width: 340px;
  max-width: 100vw;
  height: 100vh;
  background: #e0e7ff;
  box-shadow: -2px 0 12px rgba(37,99,235,0.12);
  z-index: 1000;
  padding-top: 2rem;
  overflow-y: auto;
  transition: transform 0.3s;
  border-left: 4px solid #2563eb;
}
.task-list-container {
  max-width: 1100px;
  width: 95%;
  margin-right: 40px;
}
</style>